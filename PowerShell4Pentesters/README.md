### PowerShell 4 Pentesters
#### 1.1 Intro
Why PowerShell?  
Run, download or execute code, entirely within the memory process of the powershell executable
letting penetration testers evade endpoint security solutions.

Location  
32bit: C:\windows\system32\WindowsPowershell\*  
64bit: C:\windows\SysWOW64\WindowsPowerShell\*  

C:\> powershell.exe -ExecutionPolicy Bypass ./script.ps1

_1.1.1 Useful Cmdlets 
//PS = PowerShell 
```
Get-Process
PS C:\> Get-Process chrome,firefox | Sort-Object -Unique | Format-List Path,Id //Get information about specific processes and paths to their executables.

Get-WmiObject
PS C:\> Get-WmiObject -class win32_operatingsystem | select -Property * //All information related to current operating system
PS C:\> Get-WmiObject -class win32_operatingsystem |Sort-Object -Unique PathName | fl Pathname //Paths to all service executables

Finding Files
PS C:\> Select-String -Path C:\users\christian\Documents\*.txt -Pattern pass* //Search for files of txt extension in user's 
Documents directory containing the string "pass"
PS C:\> Get-Content C:\users\christian\Documents\passwords.txt //Display full contents of file
PS C:\> Get-ChildItem C:\PowerShell\ | Where-Object {$_.Name -match “xls”} //List contents of directory and return files with string in their name (xls)
PS C:\> Get-Service //Lists all services
```
_1.1.2 Modules
```
PS C:\> Get-Module //List all currently imported modules
PS C:\> Import-Module ./module.psm1 //Import module into current PS session

Modules need to be copied into the module path, specified by the PS environment variable, to find these paths:
PS C:\> $Env:PSModulePath

PowerSploit Module
//Download PowerSploit archive, extract it and copy its contents into chosen module directory into folder called "PowerSploit"
PS C:\> Import-Module PowerSploit
PS C:\> Get-Command -Module PowerSploit //list all PowerSploit associated cmdlets
PS C:\> Get-Help Write-HihackDLL //Get help and usage for a specific cmdlet

```
